# Smart English 项目全景梳理

## 一、产品类型

**Smart English** 是一款面向中国中学生（初中 + 高中）的 AI 驱动英语学习平台。

| 维度 | 描述 |
|------|------|
| 目标用户 | K12 阶段中学生（小学/初中/高中） |
| 核心定位 | AI 英语学习 + 中高考备考 |
| 产品形态 | Web 应用（Next.js 前端 + FastAPI 后端），规划中有移动端 |
| AI 能力 | 深度集成 Claude API，用于批改、对话、内容生成、错误分析 |
| 技术栈 | FastAPI + SQLAlchemy + PostgreSQL / Next.js 14 + TypeScript + Zustand |
| 战略愿景 | 从"题库 + AI批改 + 打卡激励"转型为"用英语探索世界的入口" |
| Slogan | "别学英语，用英语。" |

---

## 二、核心功能清单

### 2.1 考试备考系统（Exam）

最完整的模块，覆盖中考/高考全流程。

| 功能 | 说明 | 后端入口 |
|------|------|---------|
| 考试档案 | 设置目标考试（中考/高考）、省份、目标分数、考试日期 | `routers/exam.py` |
| 诊断测评 | 初始能力评估，AI 分析薄弱环节，生成个性化学习计划 | `services/exam_diagnostic.py` |
| 分项训练 | 听力/阅读/写作/语法/词汇/综合 6 大板块，自适应难度 | `services/exam_training.py` |
| 模拟考试 | 全真模拟，限时作答，自动阅卷，分项成绩报告 | `services/exam_mock.py` |
| 薄弱突破 | 识别掌握度 <60% 的知识点，多阶段突破训练 | `services/exam_weakness.py` |
| 心流练习 | 沉浸式连续刷题，实时难度调节，连击追踪 | `services/exam_flow.py` |
| 错因基因分析 | 跨题型错误模式识别，生成针对性修复训练 | `services/exam_error_gene.py` |
| 分数预测 | 基于历史数据的成绩预测，分项预测 + 置信度 | `services/exam_prediction.py` |
| 时间管理 | 记录每题/每板块用时，识别时间分配问题 | `services/exam_time.py` |
| 每日冲刺计划 | AI 生成每日任务推荐，基于薄弱点和考试倒计时 | `services/exam_sprint_plan.py` |
| 自定义测验 | 用户自选知识点/难度/题量组卷 | `services/exam_custom.py` |
| 错题重练 | 从错题本中抽取错题重新练习 | `services/exam_replay.py` |

### 2.2 AI 对话辅导（Tutor / Chat）

| 功能 | 说明 |
|------|------|
| AI 英语对话 | 多模式对话（自由聊天/场景模拟/语法讲解等） |
| 流式响应 | SSE 实时流式输出 |
| 对话历史 | 保存和回顾历史对话 |

### 2.3 写作批改（Writing）

| 功能 | 说明 |
|------|------|
| 作文提交 | 按题目/自由写作 |
| AI 批改 | LLM 多维度评分（语法/词汇/结构/内容） |
| 详细反馈 | 逐句批注 + 改进建议 |

### 2.4 词汇学习（Vocabulary / Knowledge Galaxy）

| 功能 | 说明 |
|------|------|
| 知识图谱 | 词汇以图谱形式组织（同义/反义/词族/搭配/派生） |
| 星系可视化 | 前端"知识星系"可视化展示词汇关系 |
| 掌握度追踪 | 每个词 4 级状态：undiscovered → seen → familiar → mastered |
| 间隔重复 | 基于遗忘曲线的复习调度 |

### 2.5 语法学习（Grammar）

| 功能 | 说明 |
|------|------|
| 语法专题 | 按 CEFR 等级分级的语法主题 |
| 配套练习 | 每个语法点配有练习题 |
| 进度追踪 | 记录每个语法点的掌握状态和正确率 |

### 2.6 阅读理解（Reading）

| 功能 | 说明 |
|------|------|
| 阅读材料 | 分级阅读内容 |
| 理解练习 | 配套阅读理解题 |

### 2.7 错题诊所（Error Clinic）

| 功能 | 说明 |
|------|------|
| 错题本 | 自动收集所有模块的错题 |
| 错误模式识别 | AI 分析错误类型（语法混淆/词汇误用/母语迁移等） |
| 治疗方案 | 针对每种错误模式生成修复训练计划 |
| 治愈追踪 | 跟踪错误模式的修复进度 |

### 2.8 截图学英语（Screenshot Learning）

| 功能 | 说明 |
|------|------|
| 图片上传 | 截图任意内容（游戏/社交媒体/网页等） |
| AI 识别提取 | 多模态 LLM 从图片中提取英语学习点 |
| 学习卡片 | 生成词汇/语法/文化背景学习卡片 |

### 2.9 AI 剧情引擎（Story Engine）

| 功能 | 说明 |
|------|------|
| 互动故事 | AI 生成的分支剧情，用户通过英语选择推动故事 |
| 多类型模板 | 冒险/悬疑/校园/科幻等故事模板 |
| 章节系统 | 故事分章节推进，记录进度 |

### 2.10 英语竞技场（Arena）

| 功能 | 说明 |
|------|------|
| 实时 PvP 对战 | 玩家匹配，限时英语对战 |
| ELO 评分 | 竞技评分系统 |
| 赛季排行榜 | 赛季制排名 |

### 2.11 现实世界任务（Quests）

| 功能 | 说明 |
|------|------|
| 任务模板 | 预设的现实场景英语任务 |
| 任务追踪 | 领取、进行中、完成状态管理 |
| XP 奖励 | 完成任务获得经验值 |

### 2.12 游戏化与激励系统

| 功能 | 说明 |
|------|------|
| XP 经验值 | 全局经验值 + 等级系统 |
| 每日任务 | 每日自动生成学习任务 |
| 成就系统 | 里程碑成就解锁 |
| 连续学习天数 | Streak 追踪 |

### 2.13 教材同步（Textbook）

| 功能 | 说明 |
|------|------|
| 教材版本管理 | 支持多版本教材（人教版等） |
| 单元内容 | 按教材单元组织学习内容 |
| 用户绑定 | 用户选择当前使用的教材版本 |

### 2.14 其他功能

| 功能 | 说明 |
|------|------|
| 用户入职引导 | 注册后的能力评估 + 兴趣选择 + 学习目标设定 |
| 通知系统 | 系统/复习/成就/连续学习提醒 |
| 管理后台 | 用户管理、数据统计 |
| 学习时长统计 | 按模块记录学习时长 |

---

## 三、现有用户数据维度

### 3.1 用户基础信息

| 字段 | 类型 | 说明 |
|------|------|------|
| phone | String | 手机号（唯一标识） |
| grade_level | String | 学段：小学/初中/高中 |
| grade | String | 年级：七年级、高一等 |
| cefr_level | String | CEFR 英语水平：A1-C2 |
| is_admin | Boolean | 是否管理员 |
| created_at | DateTime | 注册时间 |

### 3.2 入职画像（onboarding_profiles）

| 字段 | 说明 |
|------|------|
| english_level | 自评英语水平 |
| exam_type | 备考类型（中考/高考/无） |
| interests | 兴趣标签（JSON 数组） |
| daily_goal_minutes | 每日学习目标（分钟） |
| completed | 是否完成引导 |

### 3.3 考试档案（exam_profiles）

| 字段 | 说明 |
|------|------|
| exam_type | 中考 / 高考 |
| province | 省份 |
| target_score | 目标分数 |
| exam_date | 考试日期 |
| current_estimated_score | 当前预估分数 |
| weak_sections | 薄弱板块（JSON） |
| study_plan | 学习计划（JSON） |

### 3.4 知识掌握度

| 数据表 | 追踪维度 |
|--------|---------|
| user_node_status | 每个词汇的掌握状态（4 级）、遇见次数、最后接触时间 |
| knowledge_masteries | 每个考试知识点的掌握率、练习次数、最后练习时间 |
| user_grammar_progress | 每个语法点的状态、正确率、练习次数 |

### 3.5 练习与考试记录

| 数据表 | 追踪维度 |
|--------|---------|
| diagnostic_sessions | 诊断测评：总分、各板块得分、AI 分析结果、薄弱点 |
| exam_questions | 每道题：题型、难度、知识点、用户答案、正确性、用时 |
| custom_quiz_sessions | 自定义测验：配置、得分、各板块表现 |
| daily_sprint_plans | 每日冲刺：计划任务列表、完成数、总任务数 |

### 3.6 错误数据

| 数据表 | 追踪维度 |
|--------|---------|
| error_notebook_entries | 错题：原题、用户答案、正确答案、错误类型、AI 分析、复习次数、是否已掌握 |
| error_patterns | 错误模式：模式类型、出现频率、严重度、根因分析、是否已解决 |
| treatment_plans | 治疗方案：目标模式、计划内容、状态、进度、开始/完成时间 |

### 3.7 游戏化数据

| 数据表 | 追踪维度 |
|--------|---------|
| user_xp | 总 XP、等级、连续学习天数、最长连续天数、最后活跃日 |
| achievements | 成就解锁记录 |
| daily_missions | 每日任务：类型、目标值、当前进度、是否完成、XP 奖励 |
| player_ratings | 竞技评分：ELO 分数、段位、胜/负/平场次、连胜数 |
| battle_sessions | 对战记录：对手、各方得分、胜者、题目数据 |

### 3.8 内容交互数据

| 数据表 | 追踪维度 |
|--------|---------|
| story_sessions | 故事会话：模板、当前章节、状态、用户选择历史 |
| story_chapters | 章节内容：叙事文本、选项、用户选择、学习点 |
| screenshot_lessons | 截图学习：图片 URL、AI 提取的学习点、来源类型 |
| user_quests | 任务记录：任务模板、状态、进度、提交内容、AI 反馈 |

### 3.9 学习行为数据

| 数据表 | 追踪维度 |
|--------|---------|
| learning_time_logs | 学习时长：模块名称、开始/结束时间、持续秒数 |

### 3.10 通知数据

| 数据表 | 追踪维度 |
|--------|---------|
| notifications | 通知：标题、内容、分类（system/review/achievement/streak）、已读状态、深链接 |

---

## 四、数据维度总览

```
用户画像
├── 基础信息（手机号、学段、年级、CEFR 等级）
├── 入职画像（兴趣、目标、自评水平）
└── 考试档案（考试类型、省份、目标分、预估分）

学习进度
├── 词汇掌握度（4 级状态 × 每个词）
├── 语法掌握度（状态 + 正确率 × 每个语法点）
├── 考试知识点掌握率（掌握率 × 每个知识点）
└── 教材进度（当前教材版本 + 单元）

练习记录
├── 诊断测评（总分 + 分项 + AI 分析）
├── 每题作答（答案 + 正确性 + 用时）
├── 模拟考试（总分 + 分项表现）
└── 自定义测验（配置 + 成绩）

错误分析
├── 错题本（原题 + 错因 + 复习状态）
├── 错误模式（类型 + 频率 + 严重度）
└── 治疗方案（计划 + 进度 + 状态）

游戏化
├── XP / 等级 / 连续天数
├── 成就解锁
├── 每日任务完成情况
└── 竞技评分 / 对战记录

内容交互
├── AI 对话历史
├── 故事进度与选择
├── 截图学习记录
└── 任务完成情况

行为数据
├── 各模块学习时长
└── 通知触达与阅读
```
